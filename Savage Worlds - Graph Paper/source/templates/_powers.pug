input(type='checkbox',
      name='attr_toggle_pp',
      checked=false,
      class='sheet-hidden sheet-toggle--pp')

input(type='checkbox',
      name='attr_toggle_powers_block',
      checked=false,
      class='sheet-toggle sheet-toggle--block')

.sheet-block.sheet-powers
  .sheet-header
    .sheet-header__title.sheet-powers__name
      span(name='attr_rename_block_powers', data-i18n='powers') Powers
    .sheet-header__labels
      .sheet-powers__damage
        label(title='Toggle Damage Rolls',
              data-i18n-title='toggle-damage-rolls-title',
              class='sheet-damage-roll-toggle-label')
          input.sheet-hidden(type='checkbox', name='attr_powers_damage_roll_toggle')
          span.sheet-icon ;
          span(data-i18n='powers-damage') Damage
      .sheet-powers__range
        span(data-i18n='powers-range') Range
      .sheet-powers__ap
        span(data-i18n='powers-ap') AP
      .sheet-powers__pp.sheet-a
        span(data-i18n='powers-pp') PP
      .sheet-powers__penalty.sheet-b
        span(data-i18n='powers-penalty') Penalty
      .sheet-powers__duration
        span(data-i18n='powers-duration') Duration

  input(type='checkbox',
        name='attr_powers_visibility_toggle',
        checked=true,
        class='sheet-toggle sheet-toggle--visibility')

  input(type='checkbox',
        name='attr_powers_damage_roll_toggle',
        class='sheet-damage-roll-toggle sheet-hidden')

  fieldset.repeating_powers
    .sheet-repitem
      .sheet-repitem__primary
        input(type='checkbox',
              name='attr_power_roll_button_toggle',
              class='sheet-hidden sheet-toggle')

        button(type='roll',
               name='roll_power_skill',
               value='@{power_skill}',
               class='sheet-repitem__skill-roll') 9

        input(type='text',
              name='attr_power_name',
              placeholder='Power',
              data-i18n-placeholder='powers-name-placeholder',
              spellcheck='false',
              class='sheet-align-left sheet-powers__name sheet-stretch')

        input(type='checkbox',
              name='attr_power_damage_input_toggle',
              checked=true,
              class='sheet-hidden sheet-toggle')

        .sheet-damage-button-overlay
          input(type='hidden', name='attr_power_damage_roll', value='0')

          button(type='roll',
                 name='roll_power_damage',
                 value!=`&{template:DamageRoll} {{header=@{name} ^{rolls} ^{damage}}} {{code=@{power_damage}}} {{source_label=^{source}}} {{source=@{power_name}}} {{rof=[[ ?{@{query_rate_of_fire}|1} ]]}} {{modifier=?{@{query_damage_modifier}}}} {{range=@{power_range}}} {{ap=@{power_ap}}} {{trapping=@{power_trapping}}} ${maxRof.map(n => `{{roll${n}=[[ @{power_damage_roll} + ?{@{query_damage_modifier}} ]]}}`).join(' ')} {{reroll=[r](~repeating_powers_power_damage)}}`)

          input(type='text',
                name='attr_power_damage',
                placeholder='3d6',
                data-i18n-placeholder='powers-damage-placeholder',
                spellcheck='false',
                class='sheet-powers__damage')

        input(type='text',
              name='attr_power_range',
              placeholder='Range/Melee',
              data-i18n-placeholder='powers-range-placeholder',
              spellcheck='false',
              class='sheet-powers__range')

        input(type='text',
              name='attr_power_ap',
              placeholder='0',
              spellcheck='false',
              class='sheet-powers__ap')

        input(type='text',
              name='attr_power_pp',
              placeholder='2',
              data-i18n-placeholder='powers-pp-placeholder',
              spellcheck='false',
              class='sheet-a sheet-powers__pp')

        input(type='text',
              name='attr_power_penalty',
              placeholder='-1',
              spellcheck='false',
              class='sheet-b sheet-powers__penalty')

        input(type='text',
              name='attr_power_duration',
              placeholder='Duration',
              data-i18n-placeholder='powers-duration-placeholder',
              spellcheck='false',
              class='sheet-powers__duration')

      input(type='checkbox',
            name='attr_power_notes_toggle',
            class='sheet-toggle sheet-toggle--arrow')

      .sheet-repitem__secondary
        input(type='checkbox',
              name='attr_power_trapping_toggle',
              checked=true,
              class='sheet-hidden sheet-toggle')

        .sheet-repitem__note-label
          span(data-i18n='powers-trapping-label') Trapping:
          
        input(type='text',
              name='attr_power_trapping',
              placeholder='Fire, Light, etc.',
              data-i18n-placeholder='powers-trapping-placeholder',
              spellcheck='false',
              class='sheet-align-left sheet-powers__trapping')

        .sheet-repitem__note-label
          span(data-i18n='powers-notes-label') Notes:

        input(type='text',
              name='attr_power_notes',
              placeholder='Effect/Description',
              data-i18n-placeholder='powers-notes-placeholder',
              spellcheck='false',
              class='sheet-align-left sheet-repitem__note sheet-stretch')

        input(type='checkbox',
              name='attr_power_linked_skill_toggle',
              class='sheet-toggle sheet-toggle--linked-skill')

        .sheet-repitem__settings
          .sheet-repitem__settings-content
            label.sheet-label-toggle
              input(type='checkbox', name='attr_power_damage_input_toggle', checked=true)
              span(data-i18n='damage') Damage

            label.sheet-label-toggle
              input(type='checkbox', name='attr_power_trapping_toggle', checked=true)
              span(data-i18n='trapping') Trapping

            label.sheet-label-toggle
              input(type='hidden', name='attr_power_skill', value='@{roll_full_spellcasting}')
              input(type='checkbox', name='attr_power_roll_button_toggle')
              span(data-i18n='roll-button') Roll Button
              input(type='text',
                    name='attr_power_skill_name',
                    placeholder='Skill Name',
                    data-i18n-placeholder='powers-skill-placeholder',
                    value='Spellcasting',
                    spellcheck='false',
                    class='sheet-label-toggle__input')

        input(type='checkbox',
              name='attr_power_note_box_toggle',
              class='sheet-toggle sheet-toggle--note-box')

        .sheet-repitem__note-box
          textarea(name='attr_power_note_box',
                   placeholder='Notes',
                   data-i18n-placeholder='powers-note-box-placeholder',
                   spellcheck='false')

  .sheet-footer
